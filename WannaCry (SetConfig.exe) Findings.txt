killswitch mechanism in the decompiled code and explain its functions.
--------------------------------------------------------
- In the main function of malware, the string of the killswitch URL is moved into ECX.
- The arguments for InternetOpenA are pushed onto the stack. The boolean result of InternetOpenA is moved into EAX.
- The arguments for InternetOpenUrlA are pushed onto the stack, including the killswitch URL.
The result of InternetOpenUrlA is moved into EAX. Then, this result is also moved into EDI.
- The handle is closed and the program evaluates the value of EDI. 
- If the value is 0x0 (i.e, NULL), WannaCry makes a call to the first function in the payload.
- Else, WannaCry exits without triggering the payload.


The main symptoms of a WannaCry(Setconfig.exe) infection
------------------------------------------------------

- Changed wallpaper on the infected host.
-	A program window indicating the host has been infected that has a countdown timer and pay buttons.
-	Encryption of files on the host's file system. Files are encrypted and appended with a `.WNCRY` extension.
-	The appearance of a @WanaDecryptor@ executable and a @Please_Read_Me@ text file on the desktop.

---

Using String.exe, found strings of interest
---------------------------------------
The main strings are URLs. FLOSS identifies one that is built on the process at runtime that contains unpronounceable long website name.
```
http://www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com
```

 Other main strings include paths that call to different remote ips (`\\192.168.56.20\IPC$`, `\\192.168.56.20\IPC$`), a bunch of language files in a `msg` directory  (`msg/m_korean.wnry, msg/m_bulgerian.wnry` etc), and the following:

 ```
http://www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com
%s -m security
C:\%s\qeriuwjhrf
tasksche.exe
icacls . /grant Everyone:F /T /C /Q
WNcry@2ol7 (look like a password)
 ```

---

import address table for the main executable. and API imports which is crypto library of Microsoft:
------------------------------------------

Interesting API calls include:(Microsoft API library)
- CryptGetRandom
- CryptAcquireContextA
- InternetOpenA
- InternetOpenUrl
- CreateServiceA
- ChangeServiceConfig2A


---

conditions are necessary to get this sample to detonate

attempts to initiate a connection with the weird URL:
```
http://www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com
```
If a connection is not established, the rest of the ransomware payload is executed.

If a connection is established, the program exits without executing the rest of the ransomware payload.

In a lab setting, this means that INetSim must be turned off in order to detonate the sample.

---
 the network indicators of this WannaCry sample
----------------------------------------------
- Attempted access to the weird URL.
- A flood of numerous SMB connection requests to non-private remote addresses.
- A secondary process, taskhsvc.exe, opens port 9050 to a LISTENING state and attempts to connect to non-private remote addresses over HTTPS.

---

the host-based indicators of this Setconfig.exe(WannaCry).
-------------------------------------------
- A new directory with a random character name is created in C:\ProgramData.
- The directory is set to hidden.
- This new directory contains many unpacked artifacts from WannaCry's initial detonation.
The artefacts include the taskhsvc.exe executable and a "Tor" directory that unpacks a "tor" program.
- A new service is created to start tasksche.exe as a persistent executable.

---



